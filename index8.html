<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Login - Estoque</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial,sans-serif;display:flex;justify-content:center;align-items:center;height:100vh;margin:0;background:#f0f2f5;}
.login-box{background:#fff;padding:30px;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);width:300px;}
h2{text-align:center;margin-bottom:20px;}
input{width:100%;padding:10px;margin-bottom:10px;border-radius:5px;border:1px solid #ccc;}
button{width:100%;padding:10px;border:none;border-radius:5px;background:#2563eb;color:#fff;font-weight:bold;cursor:pointer;}
button:disabled{opacity:.6;cursor:not-allowed;}
#msg{color:red;text-align:center;font-size:14px;margin-top:10px;}
</style>
</head>
<body>
<div class="login-box">
<h2>Login</h2>
<input type="email" id="email" placeholder="Email">
<input type="password" id="senha" placeholder="Senha">
<button id="btnLogin">Entrar</button>
<div id="msg"></div>
</div>

<script>
document.getElementById("btnLogin").addEventListener("click", async () => {
  const email = document.getElementById("email").value.trim();
  const senha = document.getElementById("senha").value;
  const msg = document.getElementById("msg");
  msg.textContent = "Validando...";
  if(!email || !senha){ msg.textContent="Preencha email e senha"; return; }

  try {
    const res = await fetch(window.location.href, {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({action:"login", email, senha})
    });
    const data = await res.json();
    if(data.error){ msg.textContent = data.error; return; }
    // Salva auth e redireciona para dashboard
    sessionStorage.setItem("auth", JSON.stringify(data));
    window.location.href="?page=dashboard";
  } catch(e){
    msg.textContent="Erro ao conectar com o servidor";
    console.error(e);
  }
});
</script>
</body>
</html>
